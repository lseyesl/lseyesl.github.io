<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset=utf-8"utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API | DvaJS</title>
    <meta name="description" content="React and redux based, lightweight and elm-style framework.">
    
    
    <link rel="preload" href="/assets/css/0.styles.56052c7b.css" as="style"><link rel="preload" href="/assets/js/app.0350af5f.js" as="script"><link rel="preload" href="/assets/js/7.19a2461b.js" as="script"><link rel="prefetch" href="/assets/js/10.c92e8561.js"><link rel="prefetch" href="/assets/js/11.bf005912.js"><link rel="prefetch" href="/assets/js/12.ac9cbdcf.js"><link rel="prefetch" href="/assets/js/13.630bf05d.js"><link rel="prefetch" href="/assets/js/14.660b7dd5.js"><link rel="prefetch" href="/assets/js/15.d6e76d28.js"><link rel="prefetch" href="/assets/js/16.190e2547.js"><link rel="prefetch" href="/assets/js/17.1bf4a649.js"><link rel="prefetch" href="/assets/js/2.b37273cf.js"><link rel="prefetch" href="/assets/js/3.f73926c2.js"><link rel="prefetch" href="/assets/js/4.25c1c6c7.js"><link rel="prefetch" href="/assets/js/5.bacd05e6.js"><link rel="prefetch" href="/assets/js/6.35edbabf.js"><link rel="prefetch" href="/assets/js/8.3fbf0504.js"><link rel="prefetch" href="/assets/js/9.2c969215.js">
    <link rel="stylesheet" href="../assets/css/0.styles.56052c7b.css" tppabs="https://dvajs.com/assets/css/0.styles.56052c7b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="../index.htm" tppabs="https://dvajs.com/" class="home-link router-link-active"><!----> <span class="site-name">DvaJS</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="../guide/index.htm" tppabs="https://dvajs.com/guide/" class="nav-link">æŒ‡å—</a></div><div class="nav-item"><a href="index.htm" tppabs="https://dvajs.com/api/" class="nav-link router-link-exact-active router-link-active">API</a></div><div class="nav-item"><a href="../knowledgemap/index.htm" tppabs="https://dvajs.com/knowledgemap/" class="nav-link">çŸ¥è¯†åœ°å›¾</a></div><div class="nav-item"><a href="javascript:if(confirm('https://github.com/dvajs/dva/releases  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dvajs/dva/releases'" tppabs="https://github.com/dvajs/dva/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å‘å¸ƒæ—¥å¿—
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="javascript:if(confirm('https://github.com/dvajs/dva  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dvajs/dva'" tppabs="https://github.com/dvajs/dva" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="../guide/index.htm" tppabs="https://dvajs.com/guide/" class="nav-link">æŒ‡å—</a></div><div class="nav-item"><a href="index.htm" tppabs="https://dvajs.com/api/" class="nav-link router-link-exact-active router-link-active">API</a></div><div class="nav-item"><a href="../knowledgemap/index.htm" tppabs="https://dvajs.com/knowledgemap/" class="nav-link">çŸ¥è¯†åœ°å›¾</a></div><div class="nav-item"><a href="javascript:if(confirm('https://github.com/dvajs/dva/releases  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dvajs/dva/releases'" tppabs="https://github.com/dvajs/dva/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å‘å¸ƒæ—¥å¿—
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="javascript:if(confirm('https://github.com/dvajs/dva  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dvajs/dva'" tppabs="https://github.com/dvajs/dva" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="index.htm" tppabs="https://dvajs.com/api/" class="active sidebar-link">API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="index.htm#è¾“å‡ºæ–‡ä»¶" tppabs="https://dvajs.com/api/#è¾“å‡ºæ–‡ä»¶" class="sidebar-link">è¾“å‡ºæ–‡ä»¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="index.htm#dva" tppabs="https://dvajs.com/api/#dva" class="sidebar-link">dva</a></li><li class="sidebar-sub-header"><a href="index.htm#dva-router" tppabs="https://dvajs.com/api/#dva-router" class="sidebar-link">dva/router</a></li><li class="sidebar-sub-header"><a href="index.htm#dva-fetch" tppabs="https://dvajs.com/api/#dva-fetch" class="sidebar-link">dva/fetch</a></li><li class="sidebar-sub-header"><a href="index.htm#dva-saga" tppabs="https://dvajs.com/api/#dva-saga" class="sidebar-link">dva/saga</a></li><li class="sidebar-sub-header"><a href="index.htm#dva-dynamic" tppabs="https://dvajs.com/api/#dva-dynamic" class="sidebar-link">dva/dynamic</a></li></ul></li><li class="sidebar-sub-header"><a href="index.htm#dva-api" tppabs="https://dvajs.com/api/#dva-api" class="sidebar-link">dva API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="index.htm#app-dva-opts" tppabs="https://dvajs.com/api/#app-dva-opts" class="sidebar-link">app = dva(opts)</a></li><li class="sidebar-sub-header"><a href="index.htm#app-use-hooks" tppabs="https://dvajs.com/api/#app-use-hooks" class="sidebar-link">app.use(hooks)</a></li><li class="sidebar-sub-header"><a href="index.htm#app-model-model" tppabs="https://dvajs.com/api/#app-model-model" class="sidebar-link">app.model(model)</a></li><li class="sidebar-sub-header"><a href="index.htm#app-unmodel-namespace" tppabs="https://dvajs.com/api/#app-unmodel-namespace" class="sidebar-link">app.unmodel(namespace)</a></li><li class="sidebar-sub-header"><a href="index.htm#app-replacemodel-model" tppabs="https://dvajs.com/api/#app-replacemodel-model" class="sidebar-link">app.replaceModel(model)</a></li><li class="sidebar-sub-header"><a href="index.htm#app-router-history-app-routerconfig" tppabs="https://dvajs.com/api/#app-router-history-app-routerconfig" class="sidebar-link">app.router(({ history, app }) =&gt; RouterConfig)</a></li><li class="sidebar-sub-header"><a href="index.htm#app-start-selector" tppabs="https://dvajs.com/api/#app-start-selector" class="sidebar-link">app.start(selector?)</a></li></ul></li><li class="sidebar-sub-header"><a href="index.htm#model" tppabs="https://dvajs.com/api/#model" class="sidebar-link">Model</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="index.htm#namespace" tppabs="https://dvajs.com/api/#namespace" class="sidebar-link">namespace</a></li><li class="sidebar-sub-header"><a href="index.htm#state" tppabs="https://dvajs.com/api/#state" class="sidebar-link">state</a></li><li class="sidebar-sub-header"><a href="index.htm#reducers" tppabs="https://dvajs.com/api/#reducers" class="sidebar-link">reducers</a></li><li class="sidebar-sub-header"><a href="index.htm#effects" tppabs="https://dvajs.com/api/#effects" class="sidebar-link">effects</a></li><li class="sidebar-sub-header"><a href="index.htm#subscriptions" tppabs="https://dvajs.com/api/#subscriptions" class="sidebar-link">subscriptions</a></li></ul></li></ul></li></ul> </div> <div class="page"> <div class="content"><h1 id="api"><a href="#api" aria-hidden="true" class="header-anchor">#</a> API</h1> <h2 id="è¾“å‡ºæ–‡ä»¶"><a href="#è¾“å‡ºæ–‡ä»¶" aria-hidden="true" class="header-anchor">#</a> è¾“å‡ºæ–‡ä»¶</h2> <h3 id="dva"><a href="#dva" aria-hidden="true" class="header-anchor">#</a> dva</h3> <p>é»˜è®¤è¾“å‡ºæ–‡ä»¶ã€‚</p> <h3 id="dva-router"><a href="#dva-router" aria-hidden="true" class="header-anchor">#</a> dva/router</h3> <p>é»˜è®¤è¾“å‡º <a href="javascript:if(confirm('https://github.com/ReactTraining/react-router  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/ReactTraining/react-router'" tppabs="https://github.com/ReactTraining/react-router" target="_blank" rel="noopener noreferrer">react-router<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ¥å£ï¼Œ <a href="javascript:if(confirm('https://github.com/reactjs/react-router-redux  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/reactjs/react-router-redux'" tppabs="https://github.com/reactjs/react-router-redux" target="_blank" rel="noopener noreferrer">react-router-redux<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„æ¥å£é€šè¿‡å±æ€§ routerRedux è¾“å‡ºã€‚</p> <p>æ¯”å¦‚ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Router<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> routerRedux <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'dva/router'</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dva-fetch"><a href="#dva-fetch" aria-hidden="true" class="header-anchor">#</a> dva/fetch</h3> <p>å¼‚æ­¥è¯·æ±‚åº“ï¼Œè¾“å‡º <a href="javascript:if(confirm('https://github.com/matthew-andrews/isomorphic-fetch  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/matthew-andrews/isomorphic-fetch'" tppabs="https://github.com/matthew-andrews/isomorphic-fetch" target="_blank" rel="noopener noreferrer">isomorphic-fetch<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„æ¥å£ã€‚ä¸å’Œ dva å¼ºç»‘å®šï¼Œå¯ä»¥é€‰æ‹©ä»»æ„çš„è¯·æ±‚åº“ã€‚</p> <h3 id="dva-saga"><a href="#dva-saga" aria-hidden="true" class="header-anchor">#</a> dva/saga</h3> <p>è¾“å‡º <a href="javascript:if(confirm('https://github.com/yelouafi/redux-saga  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/yelouafi/redux-saga'" tppabs="https://github.com/yelouafi/redux-saga" target="_blank" rel="noopener noreferrer">redux-saga<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„æ¥å£ï¼Œä¸»è¦ç”¨äºç”¨ä¾‹çš„ç¼–å†™ã€‚ï¼ˆç”¨ä¾‹ä¸­éœ€è¦ç”¨åˆ° effectsï¼‰</p> <h3 id="dva-dynamic"><a href="#dva-dynamic" aria-hidden="true" class="header-anchor">#</a> dva/dynamic</h3> <p>è§£å†³ç»„ä»¶åŠ¨æ€åŠ è½½é—®é¢˜çš„ util æ–¹æ³•ã€‚</p> <p>æ¯”å¦‚ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> dynamic <span class="token keyword">from</span> <span class="token string">'dva/dynamic'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> UserPageComponent <span class="token operator">=</span> <span class="token function">dynamic</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  app<span class="token punctuation">,</span>
  <span class="token function-variable function">models</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./models/users'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">component</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./routes/UserPage'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>opts</code> åŒ…å«ï¼š</p> <ul><li>app: dva å®ä¾‹ï¼ŒåŠ è½½ models æ—¶éœ€è¦</li> <li>models: è¿”å› Promise æ•°ç»„çš„å‡½æ•°ï¼ŒPromise è¿”å› dva model</li> <li>componentï¼šè¿”å› Promise çš„å‡½æ•°ï¼ŒPromise è¿”å› React Component</li></ul> <h2 id="dva-api"><a href="#dva-api" aria-hidden="true" class="header-anchor">#</a> dva API</h2> <h3 id="app-dva-opts"><a href="#app-dva-opts" aria-hidden="true" class="header-anchor">#</a> <code>app = dva(opts)</code></h3> <p>åˆ›å»ºåº”ç”¨ï¼Œè¿”å› dva å®ä¾‹ã€‚(æ³¨ï¼šdva æ”¯æŒå¤šå®ä¾‹)</p> <p><code>opts</code> åŒ…å«ï¼š</p> <ul><li><code>history</code>ï¼šæŒ‡å®šç»™è·¯ç”±ç”¨çš„ historyï¼Œé»˜è®¤æ˜¯ <code>hashHistory</code></li> <li><code>initialState</code>ï¼šæŒ‡å®šåˆå§‹æ•°æ®ï¼Œä¼˜å…ˆçº§é«˜äº model ä¸­çš„ stateï¼Œé»˜è®¤æ˜¯ <code>{}</code></li></ul> <p>å¦‚æœè¦é…ç½® history ä¸º <code>browserHistory</code>ï¼Œå¯ä»¥è¿™æ ·ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> createHistory <span class="token keyword">from</span> <span class="token string">'history/createBrowserHistory'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">dva</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  history<span class="token punctuation">:</span> <span class="token function">createHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¦å¤–ï¼Œå‡ºäºæ˜“ç”¨æ€§çš„è€ƒè™‘ï¼Œ<code>opts</code> é‡Œä¹Ÿå¯ä»¥é…æ‰€æœ‰çš„ <a href="#appusehooks">hooks</a> ï¼Œä¸‹é¢åŒ…å«å…¨éƒ¨çš„å¯é…å±æ€§ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">dva</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  history<span class="token punctuation">,</span>
  initialState<span class="token punctuation">,</span>
  onError<span class="token punctuation">,</span>
  onAction<span class="token punctuation">,</span>
  onStateChange<span class="token punctuation">,</span>
  onReducer<span class="token punctuation">,</span>
  onEffect<span class="token punctuation">,</span>
  onHmr<span class="token punctuation">,</span>
  extraReducers<span class="token punctuation">,</span>
  extraEnhancers<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="app-use-hooks"><a href="#app-use-hooks" aria-hidden="true" class="header-anchor">#</a> <code>app.use(hooks)</code></h3> <p>é…ç½® hooks æˆ–è€…æ³¨å†Œæ’ä»¶ã€‚ï¼ˆæ’ä»¶æœ€ç»ˆè¿”å›çš„æ˜¯ hooks ï¼‰</p> <p>æ¯”å¦‚æ³¨å†Œ <a href="javascript:if(confirm('https://github.com/dvajs/dva-loading  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dvajs/dva-loading'" tppabs="https://github.com/dvajs/dva-loading" target="_blank" rel="noopener noreferrer">dva-loading<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ’ä»¶çš„ä¾‹å­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> createLoading <span class="token keyword">from</span> <span class="token string">'dva-loading'</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">createLoading</span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>hooks</code> åŒ…å«ï¼š</p> <h4 id="onerror-err-dispatch"><a href="#onerror-err-dispatch" aria-hidden="true" class="header-anchor">#</a> <code>onError((err, dispatch) =&gt; {})</code></h4> <p><code>effect</code> æ‰§è¡Œé”™è¯¯æˆ– <code>subscription</code> é€šè¿‡ <code>done</code> ä¸»åŠ¨æŠ›é”™æ—¶è§¦å‘ï¼Œå¯ç”¨äºç®¡ç†å…¨å±€å‡ºé”™çŠ¶æ€ã€‚</p> <p>æ³¨æ„ï¼š<code>subscription</code> å¹¶æ²¡æœ‰åŠ  <code>try...catch</code>ï¼Œæ‰€ä»¥æœ‰é”™è¯¯æ—¶éœ€é€šè¿‡ç¬¬äºŒä¸ªå‚æ•° <code>done</code> ä¸»åŠ¨æŠ›é”™ã€‚ä¾‹å­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  subscriptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span><span class="token punctuation">,</span> done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">done</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¦‚æœæˆ‘ä»¬ç”¨ antdï¼Œé‚£ä¹ˆæœ€ç®€å•çš„å…¨å±€é”™è¯¯å¤„ç†é€šå¸¸ä¼šè¿™ä¹ˆåšï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">dva</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onError</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">,</span> <span class="token comment">/* duration */</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="onaction-fn-fn"><a href="#onaction-fn-fn" aria-hidden="true" class="header-anchor">#</a> <code>onAction(fn | fn[])</code></h4> <p>åœ¨ action è¢« dispatch æ—¶è§¦å‘ï¼Œç”¨äºæ³¨å†Œ redux ä¸­é—´ä»¶ã€‚æ”¯æŒå‡½æ•°æˆ–å‡½æ•°æ•°ç»„æ ¼å¼ã€‚</p> <p>ä¾‹å¦‚æˆ‘ä»¬è¦é€šè¿‡ <a href="javascript:if(confirm('https://github.com/evgenyrodionov/redux-logger  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/evgenyrodionov/redux-logger'" tppabs="https://github.com/evgenyrodionov/redux-logger" target="_blank" rel="noopener noreferrer">redux-logger<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ‰“å°æ—¥å¿—ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> createLogger <span class="token keyword">from</span> <span class="token string">'redux-logger'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">dva</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  onAction<span class="token punctuation">:</span> <span class="token function">createLogger</span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="onstatechange-fn"><a href="#onstatechange-fn" aria-hidden="true" class="header-anchor">#</a> <code>onStateChange(fn)</code></h4> <p><code>state</code> æ”¹å˜æ—¶è§¦å‘ï¼Œå¯ç”¨äºåŒæ­¥ <code>state</code> åˆ° localStorageï¼ŒæœåŠ¡å™¨ç«¯ç­‰ã€‚</p> <h4 id="onreducer-fn"><a href="#onreducer-fn" aria-hidden="true" class="header-anchor">#</a> <code>onReducer(fn)</code></h4> <p>å°è£… reducer æ‰§è¡Œã€‚æ¯”å¦‚å€ŸåŠ© <a href="javascript:if(confirm('https://github.com/omnidan/redux-undo  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/omnidan/redux-undo'" tppabs="https://github.com/omnidan/redux-undo" target="_blank" rel="noopener noreferrer">redux-undo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å®ç° redo/undo ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> undoable <span class="token keyword">from</span> <span class="token string">'redux-undo'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">dva</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onReducer</span><span class="token punctuation">:</span> <span class="token parameter">reducer</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> undoOpts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> newState <span class="token operator">=</span> <span class="token function">undoable</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> undoOpts<span class="token punctuation">)</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// ç”±äº dva åŒæ­¥äº† routing æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦æŠŠè¿™éƒ¨åˆ†è¿˜åŸ</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>newState<span class="token punctuation">,</span> routing<span class="token punctuation">:</span> newState<span class="token punctuation">.</span>present<span class="token punctuation">.</span>routing <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="oneffect-fn"><a href="#oneffect-fn" aria-hidden="true" class="header-anchor">#</a> <code>onEffect(fn)</code></h4> <p>å°è£… effect æ‰§è¡Œã€‚æ¯”å¦‚ <a href="javascript:if(confirm('https://github.com/dvajs/dva-loading  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dvajs/dva-loading'" tppabs="https://github.com/dvajs/dva-loading" target="_blank" rel="noopener noreferrer">dva-loading<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> åŸºäºæ­¤å®ç°äº†è‡ªåŠ¨å¤„ç† loading çŠ¶æ€ã€‚</p> <h4 id="onhmr-fn"><a href="#onhmr-fn" aria-hidden="true" class="header-anchor">#</a> <code>onHmr(fn)</code></h4> <p>çƒ­æ›¿æ¢ç›¸å…³ï¼Œç›®å‰ç”¨äº <a href="javascript:if(confirm('https://github.com/dvajs/babel-plugin-dva-hmr  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dvajs/babel-plugin-dva-hmr'" tppabs="https://github.com/dvajs/babel-plugin-dva-hmr" target="_blank" rel="noopener noreferrer">babel-plugin-dva-hmr<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ã€‚</p> <h4 id="extrareducers"><a href="#extrareducers" aria-hidden="true" class="header-anchor">#</a> <code>extraReducers</code></h4> <p>æŒ‡å®šé¢å¤–çš„ reducerï¼Œæ¯”å¦‚ <a href="javascript:if(confirm('https://github.com/erikras/redux-form  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/erikras/redux-form'" tppabs="https://github.com/erikras/redux-form" target="_blank" rel="noopener noreferrer">redux-form<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> éœ€è¦æŒ‡å®šé¢å¤–çš„ <code>form</code> reducerï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> reducer <span class="token keyword">as</span> formReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux-form'</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">dva</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  extraReducers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    form<span class="token punctuation">:</span> formReducer<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="extraenhancers"><a href="#extraenhancers" aria-hidden="true" class="header-anchor">#</a> <code>extraEnhancers</code></h4> <p>æŒ‡å®šé¢å¤–çš„ <a href="javascript:if(confirm('https://github.com/reactjs/redux/blob/master/docs/Glossary.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/reactjs/redux/blob/master/docs/Glossary.md#store-enhancer'" tppabs="https://github.com/reactjs/redux/blob/master/docs/Glossary.md#store-enhancer" target="_blank" rel="noopener noreferrer">StoreEnhancer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ï¼Œæ¯”å¦‚ç»“åˆ <a href="javascript:if(confirm('https://github.com/rt2zz/redux-persist  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/rt2zz/redux-persist'" tppabs="https://github.com/rt2zz/redux-persist" target="_blank" rel="noopener noreferrer">redux-persist<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„ä½¿ç”¨ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> persistStore<span class="token punctuation">,</span> autoRehydrate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux-persist'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">dva</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  extraEnhancers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">autoRehydrate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">persistStore</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>_store<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="app-model-model"><a href="#app-model-model" aria-hidden="true" class="header-anchor">#</a> <code>app.model(model)</code></h3> <p>æ³¨å†Œ modelï¼Œè¯¦è§  <a href="#model">#Model</a>  éƒ¨åˆ†ã€‚</p> <h3 id="app-unmodel-namespace"><a href="#app-unmodel-namespace" aria-hidden="true" class="header-anchor">#</a> <code>app.unmodel(namespace)</code></h3> <p>å–æ¶ˆ model æ³¨å†Œï¼Œæ¸…ç† reducers, effects å’Œ subscriptionsã€‚subscription å¦‚æœæ²¡æœ‰è¿”å› unlisten å‡½æ•°ï¼Œä½¿ç”¨ <code>app.unmodel</code> ä¼šç»™äºˆè­¦å‘Šâš ï¸ã€‚</p> <h3 id="app-replacemodel-model"><a href="#app-replacemodel-model" aria-hidden="true" class="header-anchor">#</a> <code>app.replaceModel(model)</code></h3> <blockquote><p>åªåœ¨app.start()ä¹‹åå¯ç”¨</p></blockquote> <p>æ›¿æ¢modelä¸ºæ–°modelï¼Œæ¸…ç†æ—§modelçš„reducers, effects å’Œ subscriptionsï¼Œä½†ä¼šä¿ç•™æ—§çš„stateçŠ¶æ€ï¼Œå¯¹äºHMRéå¸¸æœ‰ç”¨ã€‚subscription å¦‚æœæ²¡æœ‰è¿”å› unlisten å‡½æ•°ï¼Œä½¿ç”¨ <code>app.unmodel</code> ä¼šç»™äºˆè­¦å‘Šâš ï¸ã€‚</p> <p>å¦‚æœåŸæ¥ä¸å­˜åœ¨ç›¸åŒnamespaceçš„modelï¼Œé‚£ä¹ˆæ‰§è¡Œ<code>app.model</code>æ“ä½œ</p> <h3 id="app-router-history-app-routerconfig"><a href="#app-router-history-app-routerconfig" aria-hidden="true" class="header-anchor">#</a> <code>app.router(({ history, app }) =&gt; RouterConfig)</code></h3> <p>æ³¨å†Œè·¯ç”±è¡¨ã€‚</p> <p>é€šå¸¸æ˜¯è¿™æ ·çš„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Router<span class="token punctuation">,</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'dva/router'</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> history <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Router history<span class="token operator">=</span><span class="token punctuation">{</span>history<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>App<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æ¨èæŠŠè·¯ç”±ä¿¡æ¯æŠ½æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ï¼Œè¿™æ ·ç»“åˆ <a href="javascript:if(confirm('https://github.com/dvajs/babel-plugin-dva-hmr  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dvajs/babel-plugin-dva-hmr'" tppabs="https://github.com/dvajs/babel-plugin-dva-hmr" target="_blank" rel="noopener noreferrer">babel-plugin-dva-hmr<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å¯å®ç°è·¯ç”±å’Œç»„ä»¶çš„çƒ­åŠ è½½ï¼Œæ¯”å¦‚ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./router'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è€Œæœ‰äº›åœºæ™¯å¯èƒ½ä¸ä½¿ç”¨è·¯ç”±ï¼Œæ¯”å¦‚å¤šé¡µåº”ç”¨ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ä¼ å…¥è¿”å› JSX å…ƒç´ çš„å‡½æ•°ã€‚æ¯”å¦‚ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="app-start-selector"><a href="#app-start-selector" aria-hidden="true" class="header-anchor">#</a> <code>app.start(selector?)</code></h3> <p>å¯åŠ¨åº”ç”¨ã€‚<code>selector</code> å¯é€‰ï¼Œå¦‚æœæ²¡æœ‰ <code>selector</code> å‚æ•°ï¼Œä¼šè¿”å›ä¸€ä¸ªè¿”å› JSX å…ƒç´ çš„å‡½æ•°ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>é‚£ä¹ˆä»€ä¹ˆæ—¶å€™ä¸åŠ  <code>selector</code>ï¼Ÿå¸¸è§åœºæ™¯æœ‰æµ‹è¯•ã€node ç«¯ã€react-native å’Œ i18n å›½é™…åŒ–æ”¯æŒã€‚</p> <p>æ¯”å¦‚é€šè¿‡ react-intl æ”¯æŒå›½é™…åŒ–çš„ä¾‹å­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> IntlProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-intl'</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
<span class="token keyword">const</span> App <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>IntlProvider<span class="token operator">&gt;</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>IntlProvider<span class="token operator">&gt;</span><span class="token punctuation">,</span> htmlElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="model"><a href="#model" aria-hidden="true" class="header-anchor">#</a> Model</h2> <p>model æ˜¯ dva ä¸­æœ€é‡è¦çš„æ¦‚å¿µã€‚ä»¥ä¸‹æ˜¯å…¸å‹çš„ä¾‹å­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  namespace<span class="token punctuation">:</span> <span class="token string">'todo'</span><span class="token punctuation">,</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  reducers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload<span class="token punctuation">:</span> todo <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ä¿å­˜æ•°æ®åˆ° state</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> todo<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  effects<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token operator">*</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> payload<span class="token punctuation">:</span> todo <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> put<span class="token punctuation">,</span> call <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è°ƒç”¨ saveTodoToServerï¼ŒæˆåŠŸåè§¦å‘ `add` action ä¿å­˜åˆ° state</span>
      <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>saveTodoToServer<span class="token punctuation">,</span> todo<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'add'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> todo <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  subscriptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> history<span class="token punctuation">,</span> dispatch <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ç›‘å¬ history å˜åŒ–ï¼Œå½“è¿›å…¥ `/` æ—¶è§¦å‘ `load` action</span>
      <span class="token keyword">return</span> history<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> pathname <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pathname <span class="token operator">===</span> <span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'load'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>model åŒ…å« 5 ä¸ªå±æ€§ï¼š</p> <h3 id="namespace"><a href="#namespace" aria-hidden="true" class="header-anchor">#</a> namespace</h3> <p>model çš„å‘½åç©ºé—´ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä»–åœ¨å…¨å±€ state ä¸Šçš„å±æ€§ï¼Œåªèƒ½ç”¨å­—ç¬¦ä¸²ï¼Œä¸æ”¯æŒé€šè¿‡ <code>.</code> çš„æ–¹å¼åˆ›å»ºå¤šå±‚å‘½åç©ºé—´ã€‚</p> <h3 id="state"><a href="#state" aria-hidden="true" class="header-anchor">#</a> state</h3> <p>åˆå§‹å€¼ï¼Œä¼˜å…ˆçº§ä½äºä¼ ç»™ <code>dva()</code> çš„ <code>opts.initialState</code>ã€‚</p> <p>æ¯”å¦‚ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">dva</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  initialState<span class="token punctuation">:</span> <span class="token punctuation">{</span> count<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  namespace<span class="token punctuation">:</span> <span class="token string">'count'</span><span class="token punctuation">,</span>
  state<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æ­¤æ—¶ï¼Œåœ¨ <code>app.start()</code> å state.count ä¸º 1 ã€‚</p> <h3 id="reducers"><a href="#reducers" aria-hidden="true" class="header-anchor">#</a> reducers</h3> <p>ä»¥ key/value æ ¼å¼å®šä¹‰ reducerã€‚ç”¨äºå¤„ç†åŒæ­¥æ“ä½œï¼Œå”¯ä¸€å¯ä»¥ä¿®æ”¹ <code>state</code> çš„åœ°æ–¹ã€‚ç”± <code>action</code> è§¦å‘ã€‚</p> <p>æ ¼å¼ä¸º <code>(state, action) =&gt; newState</code> æˆ– <code>[(state, action) =&gt; newState, enhancer]</code>ã€‚</p> <p>è¯¦è§ï¼š https://github.com/dvajs/dva/blob/master/packages/dva-core/test/reducers.test.js</p> <h3 id="effects"><a href="#effects" aria-hidden="true" class="header-anchor">#</a> effects</h3> <p>ä»¥ key/value æ ¼å¼å®šä¹‰ effectã€‚ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œå’Œä¸šåŠ¡é€»è¾‘ï¼Œä¸ç›´æ¥ä¿®æ”¹ <code>state</code>ã€‚ç”± <code>action</code> è§¦å‘ï¼Œå¯ä»¥è§¦å‘ <code>action</code>ï¼Œå¯ä»¥å’ŒæœåŠ¡å™¨äº¤äº’ï¼Œå¯ä»¥è·å–å…¨å±€ <code>state</code> çš„æ•°æ®ç­‰ç­‰ã€‚</p> <p>æ ¼å¼ä¸º <code>*(action, effects) =&gt; void</code> æˆ– <code>[*(action, effects) =&gt; void, { type }]</code>ã€‚</p> <p>type ç±»å‹æœ‰ï¼š</p> <ul><li><code>takeEvery</code></li> <li><code>takeLatest</code></li> <li><code>throttle</code></li> <li><code>watcher</code></li></ul> <p>è¯¦è§ï¼šhttps://github.com/dvajs/dva/blob/master/packages/dva-core/test/effects.test.js</p> <h3 id="subscriptions"><a href="#subscriptions" aria-hidden="true" class="header-anchor">#</a> subscriptions</h3> <p>ä»¥ key/value æ ¼å¼å®šä¹‰ subscriptionã€‚subscription æ˜¯è®¢é˜…ï¼Œç”¨äºè®¢é˜…ä¸€ä¸ªæ•°æ®æºï¼Œç„¶åæ ¹æ®éœ€è¦ dispatch ç›¸åº”çš„ actionã€‚åœ¨ <code>app.start()</code> æ—¶è¢«æ‰§è¡Œï¼Œæ•°æ®æºå¯ä»¥æ˜¯å½“å‰çš„æ—¶é—´ã€æœåŠ¡å™¨çš„ websocket è¿æ¥ã€keyboard è¾“å…¥ã€geolocation å˜åŒ–ã€history è·¯ç”±å˜åŒ–ç­‰ç­‰ã€‚</p> <p>æ ¼å¼ä¸º <code>({ dispatch, history }, done) =&gt; unlistenFunction</code>ã€‚</p> <p>æ³¨æ„ï¼šå¦‚æœè¦ä½¿ç”¨ <code>app.unmodel()</code>ï¼Œsubscription å¿…é¡»è¿”å› unlisten æ–¹æ³•ï¼Œç”¨äºå–æ¶ˆæ•°æ®è®¢é˜…ã€‚</p></div> <div class="page-edit"><div class="edit-link"><a href="javascript:if(confirm('https://github.com/dvajs/dva/edit/master/docs/api/README.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dvajs/dva/edit/master/docs/api/README.md'" tppabs="https://github.com/dvajs/dva/edit/master/docs/api/README.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">4/9/2019, 4:18:52 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="../assets/js/app.0350af5f.js" tppabs="https://dvajs.com/assets/js/app.0350af5f.js" defer></script><script src="../assets/js/7.19a2461b.js" tppabs="https://dvajs.com/assets/js/7.19a2461b.js" defer></script>
  </body>
</html>
