<!DOCTYPE html>
<html>
  <head>
    <meta charset=utf-8"utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="https://img.alicdn.com/tfs/TB1YHEpwUT1gK0jSZFhXXaAtVXa-28-27.svg"
    />
    <link rel="stylesheet" href="../../umi.css" tppabs="https://umijs.org/umi.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.2.3
    </script>
    <title>&#x63D2;&#x4EF6;&#x6D4B;&#x8BD5;</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" href="../../zh-CN.htm" tppabs="https://umijs.org/zh-CN">UmiJS</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="../docs.htm" tppabs="https://umijs.org/zh-CN/docs">æ–‡æ¡£</a><a href="../config.htm" tppabs="https://umijs.org/zh-CN/config">é…ç½®</a><a href="../api.htm" tppabs="https://umijs.org/zh-CN/api">API</a><a href="../guide.htm" tppabs="https://umijs.org/zh-CN/guide">æŒ‡å—</a><a aria-current="page" class="active" href="../plugins.htm" tppabs="https://umijs.org/zh-CN/plugins">æ’ä»¶</a><a target="_blank" href="javascript:if(confirm('https://v2.umijs.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://v2.umijs.org/'" tppabs="https://v2.umijs.org/">v2.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a target="_blank" href="javascript:if(confirm('https://github.com/umijs/umi  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/umijs/umi'" tppabs="https://github.com/umijs/umi">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><div class="__dumi-default-locale-select" data-locale-count="2"><span>English</span></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" href="../../zh-CN.htm" tppabs="https://umijs.org/zh-CN"></a><h1>UmiJS</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="../docs.htm" tppabs="https://umijs.org/zh-CN/docs">æ–‡æ¡£</a></li><li><a href="../config.htm" tppabs="https://umijs.org/zh-CN/config">é…ç½®</a></li><li><a href="../api.htm" tppabs="https://umijs.org/zh-CN/api">API</a></li><li><a href="../guide.htm" tppabs="https://umijs.org/zh-CN/guide">æŒ‡å—</a></li><li><a aria-current="page" class="active" href="../plugins.htm" tppabs="https://umijs.org/zh-CN/plugins">æ’ä»¶</a></li><li><a target="_blank" href="javascript:if(confirm('https://v2.umijs.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://v2.umijs.org/'" tppabs="https://v2.umijs.org/">v2.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" href="javascript:if(confirm('https://github.com/umijs/umi  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/umijs/umi'" tppabs="https://github.com/umijs/umi">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-locale-select" data-locale-count="2"><span>English</span></div></div><ul class="__dumi-default-menu-list"><li><a>Presets</a><ul><li><a href="preset-react.htm" tppabs="https://umijs.org/zh-CN/plugins/preset-react"><span>@umijs/preset-react</span></a></li></ul></li><li><a>Plugins</a><ul><li><a href="plugin-access.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-access"><span>@umijs/plugin-access</span></a></li><li><a href="plugin-analytics.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-analytics"><span>@umijs/plugin-analytics</span></a></li><li><a href="plugin-antd.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-antd"><span>@umijs/plugin-antd</span></a></li><li><a href="plugin-crossorigin.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-crossorigin"><span>@umijs/plugin-crossorigin</span></a></li><li><a href="plugin-dva.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-dva"><span>@umijs/plugin-dva</span></a></li><li><a href="plugin-esbuild.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-esbuild"><span>@umijs/plugin-esbuild</span></a></li><li><a href="plugin-helmet.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-helmet"><span>@umijs/plugin-helmet</span></a></li><li><a href="plugin-initial-state.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-initial-state"><span>@umijs/plugin-initial-state</span></a></li><li><a href="plugin-layout.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-layout"><span>@umijs/plugin-layout</span></a></li><li><a href="plugin-locale.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-locale"><span>@umijs/plugin-locale</span></a></li><li><a href="plugin-model.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-model"><span>@umijs/plugin-model</span></a></li><li><a href="plugin-preact.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-preact"><span>@umijs/plugin-preact</span></a></li><li><a href="plugin-qiankun.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-qiankun"><span>@umijs/plugin-qiankun</span></a></li><li><a href="plugin-request.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-request"><span>@umijs/plugin-request</span></a></li><li><a href="plugin-sass.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-sass"><span>@umijs/plugin-sass</span></a></li><li><a href="plugin-webpack-5.htm" tppabs="https://umijs.org/zh-CN/plugins/plugin-webpack-5"><span>@umijs/plugin-webpack-5</span></a></li></ul></li><li><a>æ’ä»¶å¼€å‘</a><ul><li><a href="api.htm" tppabs="https://umijs.org/zh-CN/plugins/api"><span>æ’ä»¶ API</span></a></li><li><a aria-current="page" class="active" href="test.htm" tppabs="https://umijs.org/zh-CN/plugins/test"><span>æ’ä»¶æµ‹è¯•</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="ä¸ºä»€ä¹ˆè¦æµ‹è¯•ï¼Ÿ" data-depth="2" class=""><a href="test.htm#ä¸ºä»€ä¹ˆè¦æµ‹è¯•ï¼Ÿ" tppabs="https://umijs.org/zh-CN/plugins/test#ä¸ºä»€ä¹ˆè¦æµ‹è¯•ï¼Ÿ"><span>ä¸ºä»€ä¹ˆè¦æµ‹è¯•ï¼Ÿ</span></a></li><li title="æµ‹è¯•æ¡†æ¶" data-depth="2" class=""><a href="test.htm#æµ‹è¯•æ¡†æ¶" tppabs="https://umijs.org/zh-CN/plugins/test#æµ‹è¯•æ¡†æ¶"><span>æµ‹è¯•æ¡†æ¶</span></a></li><li title="æµ‹è¯•çº¦å®š" data-depth="2" class=""><a href="test.htm#æµ‹è¯•çº¦å®š" tppabs="https://umijs.org/zh-CN/plugins/test#æµ‹è¯•çº¦å®š"><span>æµ‹è¯•çº¦å®š</span></a></li><li title="å•å…ƒæµ‹è¯•" data-depth="2" class=""><a href="test.htm#å•å…ƒæµ‹è¯•" tppabs="https://umijs.org/zh-CN/plugins/test#å•å…ƒæµ‹è¯•"><span>å•å…ƒæµ‹è¯•</span></a></li><li title="æ’ä»¶åŠŸèƒ½" data-depth="3" class=""><a href="test.htm#æ’ä»¶åŠŸèƒ½" tppabs="https://umijs.org/zh-CN/plugins/test#æ’ä»¶åŠŸèƒ½"><span>æ’ä»¶åŠŸèƒ½</span></a></li><li title="è¿è¡Œ" data-depth="3" class=""><a href="test.htm#è¿è¡Œ" tppabs="https://umijs.org/zh-CN/plugins/test#è¿è¡Œ"><span>è¿è¡Œ</span></a></li><li title="E2E æµ‹è¯•" data-depth="2" class=""><a href="test.htm#e2e-æµ‹è¯•" tppabs="https://umijs.org/zh-CN/plugins/test#e2e-æµ‹è¯•"><span>E2E æµ‹è¯•</span></a></li><li title="ç¤ºä¾‹ä»£ç " data-depth="2" class=""><a href="test.htm#ç¤ºä¾‹ä»£ç " tppabs="https://umijs.org/zh-CN/plugins/test#ç¤ºä¾‹ä»£ç "><span>ç¤ºä¾‹ä»£ç </span></a></li><li title="TODO" data-depth="2" class=""><a href="test.htm#todo" tppabs="https://umijs.org/zh-CN/plugins/test#todo"><span>TODO</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="æ’ä»¶æµ‹è¯•"><a aria-hidden="true" href="#æ’ä»¶æµ‹è¯•"><span class="icon icon-link"></span></a>æ’ä»¶æµ‹è¯•</h1><h2 id="ä¸ºä»€ä¹ˆè¦æµ‹è¯•ï¼Ÿ"><a aria-hidden="true" href="#ä¸ºä»€ä¹ˆè¦æµ‹è¯•ï¼Ÿ"><span class="icon icon-link"></span></a>ä¸ºä»€ä¹ˆè¦æµ‹è¯•ï¼Ÿ</h2><p>Umi 3 æˆ‘ä»¬é‡‡ç”¨å¾®å†…æ ¸çš„æ¶æ„ï¼Œæ„å‘³ç€å¤§éƒ¨åˆ†åŠŸèƒ½ä»¥æ’ä»¶çš„å½¢å¼åŠ è½½ã€‚</p><p>æ‰€ä»¥<strong>æ’ä»¶è´¨é‡</strong>å¾ˆå¤§ç¨‹åº¦å†³å®šäº† Umi æ•´ä½“åŠŸèƒ½çš„<strong>ç¨³å®šæ€§</strong>ã€‚</p><p>å½“æ’ä»¶æœ‰è‰¯å¥½çš„æµ‹è¯•ç”¨ä¾‹ï¼Œèƒ½å¸¦ç»™å¾ˆå¤šä¿éšœï¼š</p><ol><li>åŠŸèƒ½è¿­ä»£ã€æŒç»­é›†æˆ</li><li>æ›´è¯¦ç»†çš„ç”¨æ³•</li><li>åˆ©äºä»£ç é‡æ„</li><li>...</li></ol><p>é‚£ä¹ˆ Umi æ’ä»¶çš„æµ‹è¯•åŒ…æ‹¬ï¼š</p><ul><li>å•å…ƒæµ‹è¯•ï¼ˆå¿…é€‰ï¼‰å  95%<ul><li>çº¯å‡½æ•°æµ‹è¯•</li><li>ä¸´æ—¶æ–‡ä»¶æµ‹è¯•</li><li>html æµ‹è¯•</li></ul></li><li>E2Eï¼ˆå¯é€‰ï¼‰å  5%</li><li>åŸºå‡†æµ‹è¯•ï¼ˆå¯é€‰ï¼‰</li></ul><h2 id="æµ‹è¯•æ¡†æ¶"><a aria-hidden="true" href="#æµ‹è¯•æ¡†æ¶"><span class="icon icon-link"></span></a>æµ‹è¯•æ¡†æ¶</h2><blockquote><p>æ³¨ï¼šå»ºè®®ç”¨äºæµ‹è¯•çš„ Node.js ç‰ˆæœ¬ â‰¥ 10</p></blockquote><ul><li><a href="javascript:if(confirm('https://www.npmjs.com/package/@umijs/test  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.npmjs.com/package/@umijs/test'" tppabs="https://www.npmjs.com/package/@umijs/test" target="_blank">@umijs/test<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæµ‹è¯•è„šæœ¬ï¼Œå†…ç½® <code>jest</code> æµ‹è¯•æ¡†æ¶</li><li><a href="javascript:if(confirm('https://testing-library.com/docs/react-testing-library/example-intro  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://testing-library.com/docs/react-testing-library/example-intro'" tppabs="https://testing-library.com/docs/react-testing-library/example-intro" target="_blank">@testing-library/react<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼ŒReact ç»„ä»¶æµ‹è¯•å·¥å…·</li><li><a href="javascript:if(confirm('https://github.com/puppeteer/puppeteer  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/puppeteer/puppeteer'" tppabs="https://github.com/puppeteer/puppeteer" target="_blank">puppeteer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼ŒHeadless æµè§ˆå™¨å·¥å…·ï¼Œç”¨äº E2E æµ‹è¯•ã€‚</li></ul><p>åªéœ€è¦åœ¨ <code>package.json</code> ä¸Šé…ç½®å¥½ <code>scripts</code> å³å¯ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-json"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="{
  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;umi-test&quot;
  },
  &quot;optionalDependencies&quot;: {
    &quot;puppeteer&quot;: &quot;^2.1.0&quot;
  },
  &quot;devDependencies&quot;: {
    &quot;umi&quot;: &quot;^3.0.0-beta.7&quot;,
    &quot;@types/jest&quot;: &quot;^25.1.2&quot;,
    &quot;@umijs/test&quot;: &quot;^3.0.0-beta.1&quot;
  }
}
" data-status="copy"></button><div class="token-line"><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token property">&quot;test&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;umi-test&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">&quot;optionalDependencies&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token property">&quot;puppeteer&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;^2.1.0&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token property">&quot;umi&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;^3.0.0-beta.7&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token property">&quot;@types/jest&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;^25.1.2&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token property">&quot;@umijs/test&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;^3.0.0-beta.1&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="æµ‹è¯•çº¦å®š"><a aria-hidden="true" href="#æµ‹è¯•çº¦å®š"><span class="icon icon-link"></span></a>æµ‹è¯•çº¦å®š</h2><p>ç›®å½•è§„èŒƒ</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text=".
â”œâ”€â”€ package.json
â”œâ”€â”€ src
â”‚Â Â  â”œâ”€â”€ fixtures # é€‚ç”¨äºæ’ä»¶å•æµ‹çš„ umi é¡¹ç›®é›†
â”‚Â Â  â”‚Â Â  â””â”€â”€ normal
â”‚Â Â  â”‚Â Â      â””â”€â”€ pages
â”‚Â Â  â”œâ”€â”€ index.test.ts # æ’ä»¶æµ‹è¯•ç”¨ä¾‹
â”‚Â Â  â”œâ”€â”€ index.ts # æ’ä»¶ä¸»æ–‡ä»¶
â”‚Â Â  â”œâ”€â”€ utils.test.ts # å·¥å…·ç±»å‡½æ•°æµ‹è¯•
â”‚Â Â  â””â”€â”€ utils.ts
â”œâ”€â”€ example # å¯ç”¨äº E2E æµ‹è¯•ï¼Œä¸€ä¸ªå®Œæ•´çš„ umi é¡¹ç›®
â”œâ”€â”€ test # e2e æµ‹è¯•ç”¨ä¾‹
â”‚Â Â  â””â”€â”€ index.e2e.ts
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ .fatherrc.ts
â””â”€â”€ yarn.lock
" data-status="copy"></button><div class="token-line"><span class="token builtin class-name">.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">â”œâ”€â”€ package.json</span></div><div class="token-line"><span class="token plain">â”œâ”€â”€ src</span></div><div class="token-line"><span class="token plain">â”‚Â Â  â”œâ”€â”€ fixtures </span><span class="token comment"># é€‚ç”¨äºæ’ä»¶å•æµ‹çš„ umi é¡¹ç›®é›†</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">â”‚Â Â  â”‚Â Â  â””â”€â”€ normal</span></div><div class="token-line"><span class="token plain">â”‚Â Â  â”‚Â Â      â””â”€â”€ pages</span></div><div class="token-line"><span class="token plain">â”‚Â Â  â”œâ”€â”€ index.test.ts </span><span class="token comment"># æ’ä»¶æµ‹è¯•ç”¨ä¾‹</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">â”‚Â Â  â”œâ”€â”€ index.ts </span><span class="token comment"># æ’ä»¶ä¸»æ–‡ä»¶</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">â”‚Â Â  â”œâ”€â”€ utils.test.ts </span><span class="token comment"># å·¥å…·ç±»å‡½æ•°æµ‹è¯•</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">â”‚Â Â  â””â”€â”€ utils.ts</span></div><div class="token-line"><span class="token plain">â”œâ”€â”€ example </span><span class="token comment"># å¯ç”¨äº E2E æµ‹è¯•ï¼Œä¸€ä¸ªå®Œæ•´çš„ umi é¡¹ç›®</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">â”œâ”€â”€ </span><span class="token builtin class-name">test</span><span class="token plain"> </span><span class="token comment"># e2e æµ‹è¯•ç”¨ä¾‹</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">â”‚Â Â  â””â”€â”€ index.e2e.ts</span></div><div class="token-line"><span class="token plain">â”œâ”€â”€ tsconfig.json</span></div><div class="token-line"><span class="token plain">â”œâ”€â”€ .fatherrc.ts</span></div><div class="token-line"><span class="token plain">â””â”€â”€ yarn.lock</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>å…¶ä¸­ <code>src/fixtures/*</code> å¯ç”¨äºæµ‹è¯• umi å„ç”Ÿå‘½å‘¨æœŸçš„é¡¹ç›®ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// src/fixtures/normal/.umirc.ts
export default {
  history: &#x27;memory&#x27;,
  mountElementId: &#x27;&#x27;,
  routes: [{ path: &#x27;/&#x27;, component: &#x27;./index&#x27; }],
};
" data-status="copy"></button><div class="token-line"><span class="token comment">// src/fixtures/normal/.umirc.ts</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword module">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  history</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;memory&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  mountElementId</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  routes</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token plain"> path</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span><span class="token plain"> component</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;./index&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><details><summary>jest é…ç½®æ¨¡å—æ˜ å°„</summary><p><del>ä¸ºäº†ä¿æŒæµ‹è¯•é¡¹ç›®ä¸çœŸå® umi é¡¹ç›®ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸€äº›æ¨¡å—è·¯å¾„åšæ˜ å°„ï¼Œæœ‰ bugï¼Œæ²¡è·‘é€šï¼š</del></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// jest.config.js
module.exports = {
  moduleNameMapper: {
    // ç¡®ä¿ import {} from &#x27;umi&#x27; æ­£å¸¸ work
    &#x27;^@@/core/umiExports<div id="root"></div>#x27;:
      &#x27;&lt;rootDir&gt;/src/fixtures/.umi-test/core/umiExports.ts&#x27;,
  },
};
" data-status="copy"></button><div class="token-line"><span class="token comment">// jest.config.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  moduleNameMapper</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// ç¡®ä¿ import {} from &#x27;umi&#x27; æ­£å¸¸ work</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token string">&#x27;^@@/core/umiExports<div id="root"></div>#x27;</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token string">&#x27;&lt;rootDir&gt;/src/fixtures/.umi-test/core/umiExports.ts&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></details><h2 id="å•å…ƒæµ‹è¯•"><a aria-hidden="true" href="#å•å…ƒæµ‹è¯•"><span class="icon icon-link"></span></a>å•å…ƒæµ‹è¯•</h2><p>æ’ä»¶å•å…ƒæµ‹è¯•å¯ä»¥æ‹†åˆ†æˆï¼š</p><ul><li>çº¯å‡½æ•°æµ‹è¯•ï¼šä¸ä¾èµ– umi çš„çº¯å‡½æ•°è¿›è¡Œæµ‹è¯•</li><li>ä¸´æ—¶æ–‡ä»¶æµ‹è¯•ï¼š<code>.umi-test</code> é¡¹ç›®å…¥å£æ–‡ä»¶çš„æµ‹è¯•</li><li>html æµ‹è¯•ï¼šå¯¹ç”Ÿæˆå‡ºæ¥çš„ <code>index.html</code> è¿›è¡Œæµ‹è¯•</li></ul><p>æˆ‘ä»¬ä»¥ <code>umi-plugin-bar</code> æ’ä»¶ä¸ºä¾‹ï¼Œå¾ªåºæ¸è¿›åœ°å­¦ä¹  Umi æ’ä»¶æµ‹è¯•ã€‚</p><h3 id="æ’ä»¶åŠŸèƒ½"><a aria-hidden="true" href="#æ’ä»¶åŠŸèƒ½"><span class="icon icon-link"></span></a>æ’ä»¶åŠŸèƒ½</h3><p><code>umi-plugin-bar</code> æ’ä»¶æä¾›çš„åŠŸèƒ½æœ‰ï¼š</p><ul><li>ä» <code>umi</code> å¯ä»¥å¯¼å‡ºå¸¸ç”¨çš„ <code>utils</code> æ–¹æ³•</li><li>æ ¹æ®é…ç½®çš„ <code>config.ga = <!-- -->{<!-- --> code: &#x27;yourId&#x27; <!-- -->}</code>ï¼ŒåŠ è½½ä¸€æ®µ ga ç»Ÿè®¡è„šæœ¬</li></ul><h4 id="çº¯å‡½æ•°æµ‹è¯•"><a aria-hidden="true" href="#çº¯å‡½æ•°æµ‹è¯•"><span class="icon icon-link"></span></a>çº¯å‡½æ•°æµ‹è¯•</h4><blockquote><p>è¿™é‡Œæˆ‘ä»¬çº¦å®šæµ‹è¯•ç”¨ä¾‹ä½¿ç”¨ test ä¹¦å†™å•æµ‹ï¼Œä¸æ¨èä½¿ç”¨ <code>describe</code> + <code>it</code> æµ‹è¯•ç”¨ä¾‹åµŒå¥—ã€‚</p></blockquote><p>çº¯å‡½æ•°ä¸ä¾èµ– umiï¼Œæµ‹è¯•èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œå»ºè®®å°†å¤æ‚åŠŸèƒ½ç‚¹æ‹†åˆ†æˆä¸€ä¸ªä¸ªçº¯å‡½æ•°ï¼Œæœ‰åˆ©äºæ’ä»¶åŠŸèƒ½æ›´æ˜“æµ‹è¯•ã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// src/utils.test.ts
import { getUserName } from &#x27;./utils&#x27;;

test(&#x27;getUserName&#x27;, () =&gt; {
  expect(getUserName(&#x27;hello world&#x27;)).toEqual(&#x27;hello world&#x27;);
});
" data-status="copy"></button><div class="token-line"><span class="token comment">// src/utils.test.ts</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> getUserName </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;./utils&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#x27;getUserName&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token string">&#x27;hello world&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toEqual</span><span class="token punctuation">(</span><span class="token string">&#x27;hello world&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h4 id="ä¸´æ—¶æ–‡ä»¶æµ‹è¯•"><a aria-hidden="true" href="#ä¸´æ—¶æ–‡ä»¶æµ‹è¯•"><span class="icon icon-link"></span></a>ä¸´æ—¶æ–‡ä»¶æµ‹è¯•</h4><p>ä¸ºäº†æµ‹è¯•å¯¼å‡ºçš„å·¥å…·ç±»å‡½æ•°åœ¨ç»„ä»¶é‡Œèƒ½æ­£å¸¸ä½¿ç”¨ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªé¦–é¡µ <code>src/fixtures/normal/index.tsx</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// çœŸå®ä½¿ç”¨ï¼šimport { getUsername } from &#x27;umi&#x27;;
// TODO: jest moduleNameMapper æ˜ å°„ @@/core/umiExports æœ‰ bug
import { getUserName } from &#x27;../.umi-test/plugin-utils/utils&#x27;;

export default () =&gt; &lt;h1&gt;{getUsername(&#x27;Hello World&#x27;)}&lt;/h1&gt;;
" data-status="copy"></button><div class="token-line"><span class="token comment">// çœŸå®ä½¿ç”¨ï¼šimport { getUsername } from &#x27;umi&#x27;;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// TODO: jest moduleNameMapper æ˜ å°„ @@/core/umiExports æœ‰ bug</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> getUserName </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;../.umi-test/plugin-utils/utils&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword module">default</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">h1</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token string">&#x27;Hello World&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">h1</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>å¯¹ä¾èµ– <code>umi</code> çš„éƒ¨åˆ†ï¼Œå¯ä»¥é€šè¿‡ä» umi ä¸­åˆ›å»ºä¸€ä¸ª <code>Service</code> å¯¹è±¡ã€‚(<code>@umijs/core</code> çš„ <code>Service</code> ä¸å†…ç½®æ’ä»¶)</p><p>ç„¶åç”¨ <code>@testing-library/react</code> ç»„ä»¶æ¸²æŸ“åº“æ¥æ¸²æŸ“å‡ºæˆ‘ä»¬çš„ç»„ä»¶ã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// src/index.test.ts
import { join } from &#x27;path&#x27;;
import { Service } from &#x27;umi&#x27;;
import { render } from &#x27;@testing-library/react&#x27;;

const fixtures = join(__dirname, &#x27;./fixtures&#x27;);

test(&#x27;normal tmp&#x27;, async () =&gt; {
  const cwd = join(fixtures, &#x27;normal&#x27;);
  const service = new Service({
    cwd,
    plugins: [require.resolve(&#x27;./&#x27;)],
  });
  // ç”¨äºäº§ç”Ÿä¸´æ—¶æ–‡ä»¶
  await service.run({
    name: &#x27;g&#x27;,
    args: {
      _: [&#x27;g&#x27;, &#x27;tmp&#x27;],
    },
  });

  const reactNode = require(join(cwd, &#x27;.umi-test&#x27;, &#x27;umi.ts&#x27;)).default;
  const { container } = render(reactNode);
  expect(container.textContent).toEqual(&#x27;Hello World&#x27;);
});
" data-status="copy"></button><div class="token-line"><span class="token comment">// src/index.test.ts</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> join </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;path&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> Service </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;umi&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> render </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;@testing-library/react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> fixtures </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">join</span><span class="token punctuation">(</span><span class="token plain">__dirname</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;./fixtures&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#x27;normal tmp&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">async</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> cwd </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">join</span><span class="token punctuation">(</span><span class="token plain">fixtures</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;normal&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> service </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">Service</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    cwd</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    plugins</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">require</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#x27;./&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// ç”¨äºäº§ç”Ÿä¸´æ—¶æ–‡ä»¶</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">await</span><span class="token plain"> service</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;g&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    args</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      _</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;g&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;tmp&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> reactNode </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token plain">cwd</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;.umi-test&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;umi.ts&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">default</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> container </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token plain">reactNode</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token plain">container</span><span class="token punctuation">.</span><span class="token plain">textContent</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token string">&#x27;Hello World&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h4 id="html-æµ‹è¯•"><a aria-hidden="true" href="#html-æµ‹è¯•"><span class="icon icon-link"></span></a>html æµ‹è¯•</h4><p>åœ¨ <code>src/fixtures/normal/.umirc.ts</code> é…ç½®ä¸­æ·»åŠ  <code>ga: <!-- -->{<!-- --> code: &#x27;testId&#x27; <!-- -->}</code> æ–¹ä¾¿æµ‹è¯• html åŠŸèƒ½ã€‚</p><p>åŒ <a href="#%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95">ä¸´æ—¶æ–‡ä»¶æµ‹è¯•</a>ï¼Œæµ‹è¯• html ç”Ÿæˆæ—¶ï¼Œæˆ‘ä»¬åªéœ€å°† <code>service</code> æ‰§è¡Œçš„å‚æ•° <code>tmp</code> æ¢æˆ <code>html</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// index.test.ts
test(&#x27;normal html&#x27;, async () =&gt; {
  const cwd = join(fixtures, &#x27;normal&#x27;);
  const service = new Service({
    cwd,
    plugins: [require.resolve(&#x27;./&#x27;)],
  });
  await service.run({
    name: &#x27;g&#x27;,
    args: {
      _: [&#x27;g&#x27;, &#x27;html&#x27;],
    },
  });

  const html = readFileSync(join(cwd, &#x27;dist&#x27;, &#x27;index.html&#x27;), &#x27;utf-8&#x27;);
  expect(html).toContain(&#x27;https://www.googletagmanager.com/gtag/js?id=testId&#x27;);
});
" data-status="copy"></button><div class="token-line"><span class="token comment">// index.test.ts</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#x27;normal html&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">async</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> cwd </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">join</span><span class="token punctuation">(</span><span class="token plain">fixtures</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;normal&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> service </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">Service</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    cwd</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    plugins</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">require</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#x27;./&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">await</span><span class="token plain"> service</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;g&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    args</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      _</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;g&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;html&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> html </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token plain">cwd</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;dist&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;index.html&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;utf-8&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token plain">html</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#x27;https://www.googletagmanager.com/gtag/js?id=testId&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="è¿è¡Œ"><a aria-hidden="true" href="#è¿è¡Œ"><span class="icon icon-link"></span></a>è¿è¡Œ</h3><p>è¿è¡Œ <code>yarn test</code>ï¼Œæµ‹è¯•ç”¨ä¾‹å°±é€šè¿‡äº†ï¼ŒğŸ‰</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="âœ yarn test
$ umi-test
 PASS  src/utils.test.ts
  âœ“ getUserName (3ms)

 PASS  src/index.test.ts
  âœ“ normal (1661ms)
  âœ“ normal html (529ms)

Test Suites: 2 passed, 2 total
Tests:       3 passed, 3 total
Snapshots:   0 total
Time:        4.257s
Ran all test suites.
    Write: dist/index.html

âœ¨  Done in 5.40s.
" data-status="copy"></button><div class="token-line"><span class="token plain">âœ </span><span class="token function">yarn</span><span class="token plain"> </span><span class="token builtin class-name">test</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ umi-test</span></div><div class="token-line"><span class="token plain"> PASS  src/utils.test.ts</span></div><div class="token-line"><span class="token plain">  âœ“ getUserName </span><span class="token punctuation">(</span><span class="token plain">3ms</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"> PASS  src/index.test.ts</span></div><div class="token-line"><span class="token plain">  âœ“ normal </span><span class="token punctuation">(</span><span class="token plain">1661ms</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  âœ“ normal html </span><span class="token punctuation">(</span><span class="token plain">529ms</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">Test Suites: </span><span class="token number">2</span><span class="token plain"> passed, </span><span class="token number">2</span><span class="token plain"> total</span></div><div class="token-line"><span class="token plain">Tests:       </span><span class="token number">3</span><span class="token plain"> passed, </span><span class="token number">3</span><span class="token plain"> total</span></div><div class="token-line"><span class="token plain">Snapshots:   </span><span class="token number">0</span><span class="token plain"> total</span></div><div class="token-line"><span class="token plain">Time:        </span><span class="token number">4</span><span class="token plain">.257s</span></div><div class="token-line"><span class="token plain">Ran all </span><span class="token builtin class-name">test</span><span class="token plain"> suites.</span></div><div class="token-line"><span class="token plain">    Write: dist/index.html</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">âœ¨  Done </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain">.40s.</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>å¦‚æœä½ å–œæ¬¢ TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ <code>yarn test -w</code> ç›‘å¬ï¼Œ<a href="javascript:if(confirm('https://github.com/umijs/umi/blob/master/docs/packages/test.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/umijs/umi/blob/master/docs/packages/test.md#usage'" tppabs="https://github.com/umijs/umi/blob/master/docs/packages/test.md#usage" target="_blank">æ›´å¤šç”¨æ³•<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p><h2 id="e2e-æµ‹è¯•"><a aria-hidden="true" href="#e2e-æµ‹è¯•"><span class="icon icon-link"></span></a>E2E æµ‹è¯•</h2><p>TODO</p><h2 id="ç¤ºä¾‹ä»£ç "><a aria-hidden="true" href="#ç¤ºä¾‹ä»£ç "><span class="icon icon-link"></span></a>ç¤ºä¾‹ä»£ç </h2><p>å®Œæ•´å®ä¾‹ä»£ç å¯å‚ç…§ï¼š</p><ul><li><a href="javascript:if(confirm('https://github.com/ycjcl868/umi3-plugin-test  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/ycjcl868/umi3-plugin-test'" tppabs="https://github.com/ycjcl868/umi3-plugin-test" target="_blank">ycjcl868/umi3-plugin-test<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="javascript:if(confirm('https://github.com/umijs/plugins/tree/master/packages/plugin-locale  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/umijs/plugins/tree/master/packages/plugin-locale'" tppabs="https://github.com/umijs/plugins/tree/master/packages/plugin-locale" target="_blank">@umijs/plugin-locale<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å›½é™…åŒ–æ’ä»¶</li><li><a href="javascript:if(confirm('https://github.com/umijs/plugins/tree/master/packages/plugin-dva  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/umijs/plugins/tree/master/packages/plugin-dva'" tppabs="https://github.com/umijs/plugins/tree/master/packages/plugin-dva" target="_blank">@umijs/plugin-dva<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> dva æ’ä»¶</li></ul><h2 id="todo"><a aria-hidden="true" href="#todo"><span class="icon icon-link"></span></a>TODO</h2><ul><li>Umi UI æ’ä»¶æµ‹è¯•æ–¹æ¡ˆ</li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" href="javascript:if(confirm('https://github.com/umijs/umi/edit/master/docs/plugins/test.zh-CN.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/umijs/umi/edit/master/docs/plugins/test.zh-CN.md'" tppabs="https://github.com/umijs/umi/edit/master/docs/plugins/test.zh-CN.md">åœ¨ GitHub ä¸Šç¼–è¾‘è¿™ç¯‡æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="æœ€åæ›´æ–°æ—¶é—´ï¼š">6/10/2020, 7:42:23 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "../../../www.google-analytics.com/analytics.js"/*tpa=https://www.google-analytics.com/analytics.js*/,
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="../../umi.js" tppabs="https://umijs.org/umi.js"></script>
  </body>
</html>
